const { Telegraf, Markup } = require('telegraf');
// const { onRequest } = require("firebase-functions/v2/https");
// const logger = require("firebase-functions/logger");
require("dotenv/config");

const bot = new Telegraf(process.env.TELEGRAM_BOT_API);

bot.start(ctx => ctx.reply(
  'üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à –∫–ª—É–± –ø–æ –ö–∏–∫–±–æ–∫—Å—É –∏ –ú—É–∞–π –¢–∞–π!',
  Markup.keyboard([
    ['üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ', 'üí∞ –¶–µ–Ω—ã'],
    ['üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è']
  ]).resize()
));

bot.hears('üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ', ctx => ctx.replyWithHTML(`
üìÖ <b>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫:</b>

ü•ä <b>–ö–∏–∫–±–æ–∫—Å / –ú—É–∞–π –¢–∞–π</b>

üìç <b>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, –°—Ä–µ–¥–∞, –ü—è—Ç–Ω–∏—Ü–∞</b>
üè¢ –ê–¥—Ä–µ—Å: –ö–∞—Ä–∞—Å—É–≤-2, –ú–∏–Ω–≥–±—É–ª–æ–∫ –∫—É—á–∞—Å–∏ (–æ—Ä–∏–µ–Ω—Ç–∏—Ä Unicon.uz)
üî∏ 18:30 - 20:20 (–ú–∞–ª–µ–Ω—å–∫–∞—è –≥—Ä—É–ø–ø–∞)
üî∏ 20:20 - 22:00 (–í–∑—Ä–æ—Å–ª–∞—è –≥—Ä—É–ø–ø–∞)

üìç <b>–í—Ç–æ—Ä–Ω–∏–∫, –ß–µ—Ç–≤–µ—Ä–≥, –°—É–±–±–æ—Ç–∞</b>
üè¢ –ê–¥—Ä–µ—Å: —É–ª–∏—Ü–∞ –ú–∞—Ö—Ç—É–º–∫—É–ª–∏, –õ–∞–∫—É—Å –∑–∞–ª
üî∏ 16:00 - 17:30 (–ú–∞–ª–µ–Ω—å–∫–∞—è –≥—Ä—É–ø–ø–∞)
`));

bot.hears('üí∞ –¶–µ–Ω—ã', ctx => ctx.replyWithHTML(`
üí∞ <b>–¶–µ–Ω—ã –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</b>

üîπ –ö–∞—Ä–∞—Å—É–≤-2 (–ú–∏–Ω–≥–±—É–ª–æ–∫ –∫—É—á–∞—Å–∏):
‚Ä¢ –ú–∞–ª–µ–Ω—å–∫–∞—è –≥—Ä—É–ø–ø–∞: 400.000 —Å—É–º/–º–µ—Å—è—Ü
‚Ä¢ –í–∑—Ä–æ—Å–ª–∞—è –≥—Ä—É–ø–ø–∞: 500.000 —Å—É–º/–º–µ—Å—è—Ü

üîπ –£–ª–∏—Ü–∞ –ú–∞—Ö—Ç—É–º–∫—É–ª–∏ (–õ–∞–∫—É—Å –∑–∞–ª):
‚Ä¢ –ú–∞–ª–µ–Ω—å–∫–∞—è –≥—Ä—É–ø–ø–∞: 450.000 —Å—É–º/–º–µ—Å—è—Ü
`));

bot.hears('üìù –ó–∞–ø–∏—Å–∞—Ç—å—Å—è', ctx => ctx.reply('‚úèÔ∏è –î–ª—è –∑–∞–ø–∏—Å–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:\n\n–§–ò–û, –í–æ–∑—Ä–∞—Å—Ç, –ê–¥—Ä–µ—Å –∑–∞–ª–∞, –î–Ω–∏ –∏ –í—Ä–µ–º—è –≥—Ä—É–ø–ø—ã.\n\n–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.'));

bot.on('text', ctx => {
  const request = ctx.message.text;
  const username = ctx.from.username ? `@${ctx.from.username}` : ctx.from.first_name;

  ctx.reply('‚úÖ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞, –º–µ–Ω–µ–¥–∂–µ—Ä —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏!');

  // –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—É
  bot.telegram.sendMessage(process.env.ADMIN_CHAT_ID, `üì© <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É:</b>\n\nüë§ –û—Ç: ${username}\nüìù –ó–∞–ø—Ä–æ—Å: ${request}`, {parse_mode: 'HTML'});
});

bot.launch().then(() => console.log('Bot started'));

// exports.trainingBot = onRequest((request, response) => {
//     logger.info("Incoming message", request.body);
    
//     return bot.handleUpdate(request.body, response).then((rv) => {
//         return !rv && response.sendStatus(200);
//     });
// })

